{% extends "base.html" %}
{% block title %}Gestión de Cursos — BBS{% endblock %}

{% block content %}
<div class="container py-4 fade-in">

  <!-- DASHBOARD DE MÉTRICAS -->
  <div class="row g-3 mb-4 text-center">
    <div class="col-md-2 col-6">
      <div class="metric-card bg-success text-white p-3 rounded shadow-sm">
        <i class="fas fa-check-circle fa-2x mb-2"></i>
        <h6 class="fw-bold mb-1">Validados</h6>
        <h4>{{ total_validados or 0 }}</h4>
      </div>
    </div>
    <div class="col-md-2 col-6">
      <div class="metric-card bg-warning text-dark p-3 rounded shadow-sm">
        <i class="fas fa-hourglass-half fa-2x mb-2"></i>
        <h6 class="fw-bold mb-1">Pendientes</h6>
        <h4>{{ total_pendientes or 0 }}</h4>
      </div>
    </div>
    <div class="col-md-2 col-6">
      <div class="metric-card bg-primary text-white p-3 rounded shadow-sm">
        <i class="fas fa-calendar-check fa-2x mb-2"></i>
        <h6 class="fw-bold mb-1">Programados</h6>
        <h4>{{ total_programados or 0 }}</h4>
      </div>
    </div>
    <div class="col-md-2 col-6">
      <div class="metric-card bg-danger text-white p-3 rounded shadow-sm">
        <i class="fas fa-times-circle fa-2x mb-2"></i>
        <h6 class="fw-bold mb-1">Cancelados</h6>
        <h4>{{ total_cancelados or 0 }}</h4>
      </div>
    </div>
    <div class="col-md-2 col-6">
      <div class="metric-card bg-secondary text-white p-3 rounded shadow-sm">
        <i class="fas fa-lock fa-2x mb-2"></i>
        <h6 class="fw-bold mb-1">Cerrados</h6>
        <h4>{{ total_cerrados or 0 }}</h4>
      </div>
    </div>
  </div>

  <!-- ENCABEZADO PRINCIPAL -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h3 class="fw-bold text-success"><i class="fas fa-book-open me-2"></i>Gestión de Cursos</h3>
      <p class="text-muted mb-0">Panel de visualización y control de cursos registrados en el sistema</p>
    </div>
    <div>
      <a href="{{ url_for('cursos.nuevo') }}" class="btn btn-success me-2">
        <i class="fas fa-plus"></i> Nuevo Curso
      </a>
      <a href="{{ url_for('cursos.desde_plantilla') }}" class="btn btn-outline-success">
        <i class="fas fa-copy"></i> Desde Plantilla
      </a>
    </div>
  </div>

  <!-- LISTADO DE CURSOS -->
  <div class="accordion" id="accordionCursos">
    <!-- Formación Profesional -->
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button bg-success text-white fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#fp">
          <i class="fas fa-layer-group me-2"></i> FORMACIÓN PROFESIONAL (FP)
        </button>
      </h2>
      <div id="fp" class="accordion-collapse collapse show">
        <div class="accordion-body">
          {% if cursos_fp %}
            <div class="row g-3">
              {% for curso in cursos_fp %}
                <div class="col-md-6 col-lg-4">
                  <div class="card shadow-sm border-0 rounded-3 h-100">
                    <div class="card-body">
                      <h5 class="fw-bold text-success">{{ curso.nombre }}</h5>
                      <p class="text-muted mb-2">Estado:
                        {% if curso.estado == 'VALIDADO' %}
                          <span class="badge bg-success">VALIDADO</span>
                        {% elif curso.estado == 'BORRADOR' %}
                          <span class="badge bg-warning text-dark">BORRADOR</span>
                        {% elif curso.estado == 'PROGRAMADO' %}
                          <span class="badge bg-primary">PROGRAMADO</span>
                        {% elif curso.estado == 'CANCELADO' %}
                          <span class="badge bg-danger">CANCELADO</span>
                        {% elif curso.estado == 'CERRADO' %}
                          <span class="badge bg-secondary">CERRADO</span>
                        {% else %}
                          <span class="badge bg-light text-dark">Desconocido</span>
                        {% endif %}
                      </p>
                      <a href="{{ url_for('cursos.detalle', curso_id=curso.id) }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye"></i> Ver detalles
                      </a>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p class="text-muted fst-italic">No hay cursos FP registrados.</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Cursos Intensivos -->
    <div class="accordion-item mt-3">
      <h2 class="accordion-header">
        <button class="accordion-button bg-success text-white fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#intensivos">
          <i class="fas fa-bolt me-2"></i> CURSOS INTENSIVOS
        </button>
      </h2>
      <div id="intensivos" class="accordion-collapse collapse show">
        <div class="accordion-body">
          {% if cursos_int %}
            <div class="row g-3">
              {% for curso in cursos_int %}
                <div class="col-md-6 col-lg-4">
                  <div class="card shadow-sm border-0 rounded-3 h-100">
                    <div class="card-body">
                      <h5 class="fw-bold text-success">{{ curso.nombre }}</h5>
                      <p class="text-muted mb-2">Estado:
                        {% if curso.estado == 'VALIDADO' %}
                          <span class="badge bg-success">VALIDADO</span>
                        {% elif curso.estado == 'BORRADOR' %}
                          <span class="badge bg-warning text-dark">BORRADOR</span>
                        {% elif curso.estado == 'PROGRAMADO' %}
                          <span class="badge bg-primary">PROGRAMADO</span>
                        {% elif curso.estado == 'CANCELADO' %}
                          <span class="badge bg-danger">CANCELADO</span>
                        {% elif curso.estado == 'CERRADO' %}
                          <span class="badge bg-secondary">CERRADO</span>
                        {% else %}
                          <span class="badge bg-light text-dark">Desconocido</span>
                        {% endif %}
                      </p>
                      <a href="{{ url_for('cursos.detalle', curso_id=curso.id) }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye"></i> Ver detalles
                      </a>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <p class="text-muted fst-italic">No hay cursos intensivos registrados.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.metric-card {
  min-height: 130px;
  transition: all .2s ease-in-out;
  display: flex;
  flex-direction: column;
  justify-content: center;
}
.metric-card:hover {
  transform: translateY(-5px);
}
</style>
{% endblock %}
